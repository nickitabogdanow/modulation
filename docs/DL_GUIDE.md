# Глубокое обучение (DL): 1D/2D CNN

Этот документ описывает пайплайн DL‑классификации: подготовка данных, архитектуры, обучение, оценка.

Смотрите также исходники:
- Подготовка: `dl_prep.py`
- Модели: `models_dl.py`
- Обучение: `train_dl.py`
- Сравнение ML vs DL: `evaluate_compare.py`

---

## 1. Варианты входных представлений

- 1D‑CNN по IQ: вход формы `(T, 2)` (каналы I и Q).
  - Плюсы: работает по «сырому» сигналу, сохраняет фазово‑амплитудную информацию.
- 2D‑CNN по спектрограммам: вход формы `(F, T, 1)` после `scipy.signal.spectrogram`.
  - Плюсы: удобно для визуального анализа частотно‑временных паттернов (FM/FSK/AM).

---

## 2. Подготовка данных (`dl_prep.py`)

- Загрузка NPZ (`data/train_*.npz` и т.п.).
- Стандартизация (например, по мини‑батчу) и простые аугментации (по желанию):
  - Случайные повороты фазы, небольшие сдвиги по времени.
- Сборка `tf.data.Dataset` c буферами, батчами, перетасовкой.

---

## 3. Модели (`models_dl.py`)

- 1D‑CNN: стек `Conv1D + BN + ReLU + Pool`, затем полносвязные слои, softmax.
- 2D‑CNN: стек `Conv2D + BN + ReLU + Pool`, вход — спектрограмма/мел‑спектрограмма.
- Реком.: используйте `dropout`, `batch_norm`, следите за receptive field.

---

## 4. Обучение (`train_dl.py`)

- Лоссы/оптимизаторы: `SparseCategoricalCrossentropy`, `Adam`.
- Колбэки: ранняя остановка, снижение LR при плато, чекпоинт лучшей валидации (`checkpoints_1d/best.keras`).
- Мониторинг: accuracy/f1 по эпохам, логгирование.

Запуск:
```bash
python train_dl.py
```

---

## 5. Оценка и сравнение

- Используйте `evaluate_compare.py` для построения Accuracy/F1 vs SNR и матриц ошибок.
- Смотрите также `error_analysis.py` для подробной диагностики ошибок.

---

## 6. Советы

- Баланс классов/стратификация по SNR обязательны.
- Для 2D‑ветки аккуратно подбирайте `nperseg/noverlap` в спектрограмме (см. `THEORY_BEGINNER.md`, §20).
- Проверяйте устойчивость к CFO/фазовому шуму/IQ‑дисбалансу — добавляйте аугментации или компенсаторы.
