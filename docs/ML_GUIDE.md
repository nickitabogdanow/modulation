# Классический ML: признаки и модели

Этот документ описывает «ручные» признаки, пайплайн классического ML, процедуру обучения/валидации и основные команды.

Смотрите также исходники:
- Признаки: `features.py`, запуск: `features_run.py`
- Обучение/оценка: `train_ml.py`
- Сравнение ML vs DL: `evaluate_compare.py`

---

## 1. Признаки

- Мгновенные (из комплексной огибающей `x = I + jQ`):
  - Амплитуда `|x|`, фаза `∠x`, мгновенная частота `f_inst` (через разность развернутой фазы).
  - Статистики: mean, std, skew, kurtosis, circular stats для фаз.
- Спектральные:
  - Полосы энергии (bandpowers), spectral centroid, rolloff, эффективная ширина полосы.
- Высшие порядки (кумулянты): `c20, c40, c42` с нормировкой.
- IQ‑статистика: корреляции, отношение мощностей I/Q, и т.п.

Файл: `features.py` (см. функции `instantaneous_features`, `spectral_features`, `cumulant_features`, `iq_stats`).

---

## 2. Пайплайн формирования датасета признаков

- Источник данных: `data/*.npz` (train/val/test) с IQ‑окнами и метками модулей/SNR.
- Запуск: `python features_run.py`
  - Загружает NPZ, извлекает признаки для каждого окна, сохраняет матрицы признаков и метки.

---

## 3. Модели и обучение

- Основные модели: LightGBM / XGBoost (если доступны), fallback — `HistGradientBoostingClassifier` из sklearn.
- Кросс‑валидация: стратифицированная по классам.
- Поиск гиперпараметров: random search.
- Метрики: Accuracy, F1 (macro/micro), матрица ошибок, усреднение по SNR‑бинам.

Запуск: `python train_ml.py` (конфиг внутри файла, можно править поиск).

---

## 4. Советы

- Баланс классов и стратификация по SNR обязательны для корректной оценки.
- Нормируйте признаки (в коде предусмотрено масштабирование/стандартизация).
- Полезно анализировать важность признаков (feature importance) и ошибки по классам.

---

## 5. Ссылки

- Теория по признакам: `THEORY_BEGINNER.md` (§6, §21, §22)
- Визуализация примеров: `quick_check.py`
