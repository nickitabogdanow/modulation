# Датасеты и генерация данных

Этот документ описывает, как формируются обучающие/валидационные/тестовые данные, как устроены NPZ‑файлы, и как повторить генерацию.

Смотрите также исходники: `dataset_builder.py`, `generators.py`, `channel.py`.

---

## 1. Формат данных

- Файлы: `data/train_v*.npz`, `data/val_v*.npz`, `data/test_v*.npz`
- Ключи внутри NPZ (пример):
  - `X`: массив формы `(N, T, 2)` — окна IQ; `T` — длина окна в отсчётах, последний канал — I/Q.
  - `y`: вектор меток модулей длины `N` (строки/индексы).
  - `snr`: вектор SNR для каждого окна.
  - `meta`: опционально словарь с конфигурацией генерации.

---

## 2. Генерация синтетики

- Генераторы модуляций: `generators.py` — PSK/QAM/FSK/AM/FM.
- Искажения канала: `channel.py` — AWGN, CFO, фазовый шум, тайминг‑оффсет, I/Q‑несбаланс, мультипуть.
- Импульсная фильтрация: RRC (для линейных), Gaussian (для GFSK).

---

## 3. Стратификация и сетка SNR

- Данные собираются по сетке (модуляция × SNR), чтобы обеспечить сбалансированное обучение и оценку.
- При разделении на train/val/test соблюдается стратификация по модуляции и SNR.

---

## 4. Повтор генерации

- Скрипт: `dataset_builder.py`
- На входе: список модуляций, список SNR‑бинов, число окон на комбинацию.
- На выходе: NPZ с массивами `X`, `y`, `snr`.

---

## 5. Проверка качества данных

- Используйте `quick_check.py` для визуализации примеров (временные сигналы, созвездия, спектры).
- Смотрите распределение классов и SNR после разбиения (балансировка).
- Проверяйте, что размеры окон и `sps` соответствуют ожиданиям модели DL/ML.
